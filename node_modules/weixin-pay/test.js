
var WXPay = require('./index');
var fs = require('fs');

var wxpay = WXPay({
	appid: 'wxae304368006e4bd1',
	mch_id: '1239335902',
	partner_key: '74D758DFC760BEEEA4DED74C16724DA2',
	//pfx: fs.readFileSync('./wxpay_cert.p12')
});

var otn = '201505027'+Math.random().toString().substr(2, 10);
console.log(otn);

wxpay.createUnifiedOrder({
	body: '扫码支付测试',
	detail: '这是模式二',
	out_trade_no: otn,
	total_fee: 1,
	spbill_create_ip: '192.168.2.210',
	trade_type: 'NATIVE',
	notify_url: 'http://weixin.5usport.com/wxpay/notify',
	product_id: '1234567890',
}, function(err, result){
	console.log(result);
});

//wxpay.getBrandWCPayRequestParams({
//    openid: '微信用户 openid',
//    body: '公众号支付测试',
//    detail: '公众号支付测试',
//    out_trade_no: '20150331'+Math.random().toString().substr(2, 10),
//    total_fee: 1,
//    spbill_create_ip: '192.168.2.210',
//    notify_url: 'http://wxpay_notify_url'
//}, function(err, result){
//    // in express
//    res.render('wxpay/jsapi', { payargs:result })
//
//});

//var prepayurl = wxpay.createMerchantPrepayUrl({ product_id: '123456' });
//console.log(prepayurl);

// wxpay.queryOrder({ transaction_id:"1000630457201504020042501133" }, function(err, order){
// 	console.log(err, order);
// });

//wxpay.queryOrder({ out_trade_no:"201503313037720683" }, function(err, order){
//	console.log(err, order);
//});

//wxpay.closeOrder({ out_trade_no:"201407030197120828"}, function(err, result){
//	console.log(result);
//});